
.mb-4(class= showHeader?"col-sm-12 col-md-6 col-xl-4":"col-12 col-xxl-6", id=`expense-${expense.id}`)
    .card.expense-card.p-2
        if !(expense.claimId || expense.claimComplete)
            input(type="checkbox", id=`ep-checkbox-${expense.id}`, name="select-expense", value=expense.id, v-model="selectedExpenses")
        .d-flex.flex-column(class=(expense.claimId || expense.claimComplete)?'expense-card-contents':'expense-card-selectable-contents')

            .row.m-2
                .col.d-flex.justify-content-between
                    .text-start.card-identifier.flex-grow-1
                        span.card-created-date.expense-date(data-iso=expense.spentOn.toISOString()) #{expense.spentOn.toUTCString()}
                    .text-end.card-amount.expense-amount(data-money=formatMoney(expense.amount, true)) #{formatMoney(expense.amount)}
            .row.m-2
                div(class=expense.attachments.length > 0 ? "col-6" :  "col-12")
                    .card-entity-name Claim
                    .card-entity-value
                        i(class=`bi bi-${expense.category.icon}`)
                        .inline.expense-category-name #{expense.category.name}
                    if expense.description
                        .card-entity-desc.expense-description #{expense.description}
                if (expense.attachments.length > 0)
                    .col-6
                        .card-entity-name Attachments
                        .card-entity-desc Tap to open
                        .d-flex.flex-wrap.gap-2.mt-2#image-container
                            each attachment in expense.attachments
                                .expense-card-attachment
                                    case attachment.mimeType
                                        when "image/jpeg"
                                        when "image/jpg"
                                        when "image/png"
                                            img(src=attachment.fileUrl)


                                        when "application/pdf"
                                            a(href=attachment.fileUrl, target="_blank")
                                                svg.bi.bi-file-earmark-pdf(viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg")
                                                    path(d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z")
                                                    path(d="M4.603 14.087a.8.8 0 0 1-.438-.42c-.195-.388-.13-.776.08-1.102.198-.307.526-.568.897-.787a7.7 7.7 0 0 1 1.482-.645 20 20 0 0 0 1.062-2.227 7.3 7.3 0 0 1-.43-1.295c-.086-.4-.119-.796-.046-1.136.075-.354.274-.672.65-.823.192-.077.4-.12.602-.077a.7.7 0 0 1 .477.365c.088.164.12.356.127.538.007.188-.012.396-.047.614-.084.51-.27 1.134-.52 1.794a11 11 0 0 0 .98 1.686 5.8 5.8 0 0 1 1.334.05c.364.066.734.195.96.465.12.144.193.32.2.518.007.192-.047.382-.138.563a1.04 1.04 0 0 1-.354.416.86.86 0 0 1-.51.138c-.331-.014-.654-.196-.933-.417a5.7 5.7 0 0 1-.911-.95 11.7 11.7 0 0 0-1.997.406 11.3 11.3 0 0 1-1.02 1.51c-.292.35-.609.656-.927.787a.8.8 0 0 1-.58.029m1.379-1.901q-.25.115-.459.238c-.328.194-.541.383-.647.547-.094.145-.096.25-.04.361q.016.032.026.044l.035-.012c.137-.056.355-.235.635-.572a8 8 0 0 0 .45-.606m1.64-1.33a13 13 0 0 1 1.01-.193 12 12 0 0 1-.51-.858 21 21 0 0 1-.5 1.05zm2.446.45q.226.245.435.41c.24.19.407.253.498.256a.1.1 0 0 0 .07-.015.3.3 0 0 0 .094-.125.44.44 0 0 0 .059-.2.1.1 0 0 0-.026-.063c-.052-.062-.2-.152-.518-.209a4 4 0 0 0-.612-.053zM8.078 7.8a7 7 0 0 0 .2-.828q.046-.282.038-.465a.6.6 0 0 0-.032-.198.5.5 0 0 0-.145.04c-.087.035-.158.106-.196.283-.04.192-.03.469.046.822q.036.167.09.346z")
                                        default
                                            a(href=attachment.fileUrl, target="_blank", download)
                                                svg.bi.bi-file-earmark-arrow-down( viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg")
                                                    path(d="M8.5 6.5a.5.5 0 0 0-1 0v3.793L6.354 9.146a.5.5 0 1 0-.708.708l2 2a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 10.293z")
                                                    path(d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z")

            if showHeader
                .row.m-2
                    .d-flex.gap-2.align-items-center
                        if (expense.claimId)
                            if (expense.claimComplete)
                                .claim-status-badge.claim-completed.rounded-pill Claimed
                            else
                                span.d-inline-block(tabindex="0", data-bs-toggle="tooltip" data-bs-title="This expense is part of a claim. To make changes to it, cancel the claim first.")
                                    button.btn.btn-outline-primary.rounded-pill.action-button(disabled="")
                                        i.bi.bi-pencil-fill
                                span.d-inline-block(tabindex="0", data-bs-toggle="tooltip" data-bs-title="This expense is part of a claim. To make changes to it, cancel the claim first.")
                                    button.btn.btn-outline-secondary.rounded-pill.action-button(disabled="")
                                        i.bi.bi-paperclip
                                span.d-inline-block(tabindex="0", data-bs-toggle="tooltip" data-bs-title="This expense is part of a claim. To make changes to it, cancel the claim first.")
                                    button.btn.btn-outline-danger.rounded-pill.action-button(disabled="")
                                        i.bi.bi-trash3-fill
                                .claim-status-badge.claim-pending.rounded-pill In a claim

                        else
                            button.btn.btn-outline-primary.rounded-pill.action-button(data-action='edit', data-expense-id=expense.id)
                                i.bi.bi-pencil-fill
                            button.btn.btn-outline-secondary.rounded-pill.action-button(data-action='attachments', data-expense-id=expense.id)
                                i.bi.bi-paperclip
                            button.btn.btn-outline-danger.rounded-pill.action-button(data-action='delete', data-expense-id=expense.id)
                                i.bi.bi-trash3-fill


